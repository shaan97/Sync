\hypertarget{classshaan97_1_1sync_1_1_server}{}\section{shaan97\+:\+:sync\+:\+:Server Class Reference}
\label{classshaan97_1_1sync_1_1_server}\index{shaan97\+::sync\+::\+Server@{shaan97\+::sync\+::\+Server}}


{\ttfamily \#include $<$Server.\+h$>$}



Collaboration diagram for shaan97\+:\+:sync\+:\+:Server\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classshaan97_1_1sync_1_1_server__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classshaan97_1_1sync_1_1_server_ac9ad7c8bb7fe2f5da5101da1297c9ae1}{Server} (boost\+::asio\+::io\+\_\+service \&io\+\_\+service)
\item 
virtual \hyperlink{classshaan97_1_1sync_1_1_server_a4b3aa2579cb1c8cd1d069582c14d0fa6}{$\sim$\+Server} ()
\begin{DoxyCompactList}\small\item\em A virtual destructor, declared only in case the future releases feature inheritance. \end{DoxyCompactList}\item 
\hyperlink{classshaan97_1_1sync_1_1_server_a8b4a5707430edcd54c02b940bc95bc30}{Server} (const \hyperlink{classshaan97_1_1sync_1_1_server}{Server} \&s)=delete
\item 
\hyperlink{classshaan97_1_1sync_1_1_server}{Server} \& \hyperlink{classshaan97_1_1sync_1_1_server_ae5e4a1ad89562429b73ab4c398d5d2fb}{operator=} (const \hyperlink{classshaan97_1_1sync_1_1_server}{Server} \&s)=delete
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{group___connection_handling_gab19cf3e5b775cd1b4eeb6d936340e712}{start\+\_\+accept} ()
\item 
void \hyperlink{group___connection_handling_ga447569609c9d667ab509e61d1dd1b476}{handle\+\_\+accept} (std\+::shared\+\_\+ptr$<$ boost\+::asio\+::ip\+::tcp\+::socket $>$ \&socket, const boost\+::system\+::error\+\_\+code \&error)
\item 
void \hyperlink{group___message_handling_ga81c419040ae028471a5737c4c0c50e3f}{create\+Group} (std\+::shared\+\_\+ptr$<$ boost\+::asio\+::ip\+::tcp\+::socket $>$ \&socket, \hyperlink{structshaan97_1_1sync_1_1_message}{Message} \&message)
\item 
void \hyperlink{group___message_handling_gaeb034e1663dff12c80bf7661f6216fe7}{add\+To\+Group} (std\+::shared\+\_\+ptr$<$ boost\+::asio\+::ip\+::tcp\+::socket $>$ \&socket, \hyperlink{structshaan97_1_1sync_1_1_message}{Message} \&message)
\item 
void \hyperlink{group___message_handling_gaedbdfea1f476a81e5f1ff3b632db9bad}{delete\+Group} (std\+::shared\+\_\+ptr$<$ boost\+::asio\+::ip\+::tcp\+::socket $>$ \&socket, \hyperlink{structshaan97_1_1sync_1_1_message}{Message} \&message)
\item 
void \hyperlink{group___message_handling_ga56230c5225416d342206232d3f2b8f6e}{handle\+\_\+heartbeat} (\hyperlink{structshaan97_1_1sync_1_1_message}{Message} \&heartbeat)
\item 
void \hyperlink{group___message_handling_ga46e08d6ffcd45a73aac315e8393e0228}{promote\+Member} (std\+::shared\+\_\+ptr$<$ boost\+::asio\+::ip\+::tcp\+::socket $>$ \&socket, \hyperlink{structshaan97_1_1sync_1_1_message}{Message} \&message)
\end{DoxyCompactItemize}
\subsection*{Static Private Member Functions}
\begin{DoxyCompactItemize}
\item 
static void \hyperlink{group___error_reporting_ga360b9e55725804cfba4a86c040001342}{send\+Failure} (std\+::shared\+\_\+ptr$<$ boost\+::asio\+::ip\+::tcp\+::socket $>$ \&socket, const \hyperlink{classshaan97_1_1sync_1_1_error}{Error} \&error)
\item 
static void \hyperlink{group___error_reporting_gaf606f6afc7f26d76733c7299599dd097}{send\+Success} (std\+::shared\+\_\+ptr$<$ boost\+::asio\+::ip\+::tcp\+::socket $>$ \&socket)
\item 
static void \hyperlink{group___error_reporting_ga1b81d60d6c76ec6852c73f2749e6e2a4}{send\+Success} (std\+::shared\+\_\+ptr$<$ boost\+::asio\+::ip\+::tcp\+::socket $>$ \&socket, const \hyperlink{classshaan97_1_1sync_1_1_error}{Error} \&error)
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::unordered\+\_\+map$<$ \hyperlink{namespaceshaan97_1_1sync_a34cebf175d27dfc3d82f24608f7043c1}{G\+R\+O\+U\+P\+\_\+\+ID}, \hyperlink{classshaan97_1_1sync_1_1_group}{Group} $>$ \hyperlink{classshaan97_1_1sync_1_1_server_a9c7e24eecc094689890f9dd97df3dd50}{groups}
\item 
std\+::unordered\+\_\+map$<$ \hyperlink{namespaceshaan97_1_1sync_a34cebf175d27dfc3d82f24608f7043c1}{G\+R\+O\+U\+P\+\_\+\+ID}, std\+::pair$<$ std\+::time\+\_\+t, std\+::mutex $>$ $>$ \hyperlink{classshaan97_1_1sync_1_1_server_a031f6b51241c6440b6bc452ddcd124f5}{heartbeats}
\item 
std\+::mutex \hyperlink{classshaan97_1_1sync_1_1_server_a613155fba91990f1c9e2b0852a752110}{group\+Size\+Lock}
\item 
boost\+::asio\+::ip\+::tcp\+::acceptor \hyperlink{classshaan97_1_1sync_1_1_server_abcdfb6bb878a7996b144b15415640b8e}{acceptor}
\begin{DoxyCompactList}\small\item\em Used to accept incoming connections (asynchronously) \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
This is one of the most important components as it represents the \hyperlink{classshaan97_1_1sync_1_1_server}{Server} In particular, this \hyperlink{classshaan97_1_1sync_1_1_server}{Server} manages the various Groups, and takes incoming connections and forwards them to the appropriate \hyperlink{classshaan97_1_1sync_1_1_group}{Group}. 

\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classshaan97_1_1sync_1_1_server_ac9ad7c8bb7fe2f5da5101da1297c9ae1}\label{classshaan97_1_1sync_1_1_server_ac9ad7c8bb7fe2f5da5101da1297c9ae1}} 
\index{shaan97\+::sync\+::\+Server@{shaan97\+::sync\+::\+Server}!Server@{Server}}
\index{Server@{Server}!shaan97\+::sync\+::\+Server@{shaan97\+::sync\+::\+Server}}
\subsubsection{\texorpdfstring{Server()}{Server()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily Server\+::\+Server (\begin{DoxyParamCaption}\item[{boost\+::asio\+::io\+\_\+service \&}]{io\+\_\+service }\end{DoxyParamCaption})}

The main constructor for the \hyperlink{classshaan97_1_1sync_1_1_server}{Server}, which sets up the network capabilities using a {\ttfamily boost\+::asio\+::io\+\_\+service} object.


\begin{DoxyParams}{Parameters}
{\em io\+\_\+service} & This parameter is necessary for conducting all boost\+::asio services. \\
\hline
\end{DoxyParams}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classshaan97_1_1sync_1_1_server_ac9ad7c8bb7fe2f5da5101da1297c9ae1_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classshaan97_1_1sync_1_1_server_a4b3aa2579cb1c8cd1d069582c14d0fa6}\label{classshaan97_1_1sync_1_1_server_a4b3aa2579cb1c8cd1d069582c14d0fa6}} 
\index{shaan97\+::sync\+::\+Server@{shaan97\+::sync\+::\+Server}!````~Server@{$\sim$\+Server}}
\index{````~Server@{$\sim$\+Server}!shaan97\+::sync\+::\+Server@{shaan97\+::sync\+::\+Server}}
\subsubsection{\texorpdfstring{$\sim$\+Server()}{~Server()}}
{\footnotesize\ttfamily Server\+::$\sim$\+Server (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



A virtual destructor, declared only in case the future releases feature inheritance. 

\mbox{\Hypertarget{classshaan97_1_1sync_1_1_server_a8b4a5707430edcd54c02b940bc95bc30}\label{classshaan97_1_1sync_1_1_server_a8b4a5707430edcd54c02b940bc95bc30}} 
\index{shaan97\+::sync\+::\+Server@{shaan97\+::sync\+::\+Server}!Server@{Server}}
\index{Server@{Server}!shaan97\+::sync\+::\+Server@{shaan97\+::sync\+::\+Server}}
\subsubsection{\texorpdfstring{Server()}{Server()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily shaan97\+::sync\+::\+Server\+::\+Server (\begin{DoxyParamCaption}\item[{const \hyperlink{classshaan97_1_1sync_1_1_server}{Server} \&}]{s }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [delete]}}

There should be no reason to copy a server exactly, since we wouldn\textquotesingle{}t want two servers trying to conduct the exact same I/O service. Thus we explicitly delete this capability. 

\subsection{Member Function Documentation}
\mbox{\Hypertarget{classshaan97_1_1sync_1_1_server_ae5e4a1ad89562429b73ab4c398d5d2fb}\label{classshaan97_1_1sync_1_1_server_ae5e4a1ad89562429b73ab4c398d5d2fb}} 
\index{shaan97\+::sync\+::\+Server@{shaan97\+::sync\+::\+Server}!operator=@{operator=}}
\index{operator=@{operator=}!shaan97\+::sync\+::\+Server@{shaan97\+::sync\+::\+Server}}
\subsubsection{\texorpdfstring{operator=()}{operator=()}}
{\footnotesize\ttfamily \hyperlink{classshaan97_1_1sync_1_1_server}{Server}\& shaan97\+::sync\+::\+Server\+::operator= (\begin{DoxyParamCaption}\item[{const \hyperlink{classshaan97_1_1sync_1_1_server}{Server} \&}]{s }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [delete]}}





There should be no reason to copy a server exactly, since we wouldn\textquotesingle{}t want two servers trying to conduct the exact same I/O service. Thus we explicitly delete this capability. 

\subsection{Member Data Documentation}
\mbox{\Hypertarget{classshaan97_1_1sync_1_1_server_abcdfb6bb878a7996b144b15415640b8e}\label{classshaan97_1_1sync_1_1_server_abcdfb6bb878a7996b144b15415640b8e}} 
\index{shaan97\+::sync\+::\+Server@{shaan97\+::sync\+::\+Server}!acceptor@{acceptor}}
\index{acceptor@{acceptor}!shaan97\+::sync\+::\+Server@{shaan97\+::sync\+::\+Server}}
\subsubsection{\texorpdfstring{acceptor}{acceptor}}
{\footnotesize\ttfamily boost\+::asio\+::ip\+::tcp\+::acceptor shaan97\+::sync\+::\+Server\+::acceptor\hspace{0.3cm}{\ttfamily [private]}}



Used to accept incoming connections (asynchronously) 

\mbox{\Hypertarget{classshaan97_1_1sync_1_1_server_a9c7e24eecc094689890f9dd97df3dd50}\label{classshaan97_1_1sync_1_1_server_a9c7e24eecc094689890f9dd97df3dd50}} 
\index{shaan97\+::sync\+::\+Server@{shaan97\+::sync\+::\+Server}!groups@{groups}}
\index{groups@{groups}!shaan97\+::sync\+::\+Server@{shaan97\+::sync\+::\+Server}}
\subsubsection{\texorpdfstring{groups}{groups}}
{\footnotesize\ttfamily std\+::unordered\+\_\+map$<$\hyperlink{namespaceshaan97_1_1sync_a34cebf175d27dfc3d82f24608f7043c1}{G\+R\+O\+U\+P\+\_\+\+ID}, \hyperlink{classshaan97_1_1sync_1_1_group}{Group}$>$ shaan97\+::sync\+::\+Server\+::groups\hspace{0.3cm}{\ttfamily [private]}}

Map keeping track of the various Groups based on their ID\textquotesingle{}s. Can be used to help forward clients to the appropriate group since queries involve G\+ID \mbox{\Hypertarget{classshaan97_1_1sync_1_1_server_a613155fba91990f1c9e2b0852a752110}\label{classshaan97_1_1sync_1_1_server_a613155fba91990f1c9e2b0852a752110}} 
\index{shaan97\+::sync\+::\+Server@{shaan97\+::sync\+::\+Server}!group\+Size\+Lock@{group\+Size\+Lock}}
\index{group\+Size\+Lock@{group\+Size\+Lock}!shaan97\+::sync\+::\+Server@{shaan97\+::sync\+::\+Server}}
\subsubsection{\texorpdfstring{group\+Size\+Lock}{groupSizeLock}}
{\footnotesize\ttfamily std\+::mutex shaan97\+::sync\+::\+Server\+::group\+Size\+Lock\hspace{0.3cm}{\ttfamily [private]}}

Grab this lock whenever
\begin{DoxyEnumerate}
\item You are using an iterator for the groups (they only stay valid so long as the size is the same).
\item You are inserting/deleting/replacing a \hyperlink{classshaan97_1_1sync_1_1_group}{Group} 
\end{DoxyEnumerate}\mbox{\Hypertarget{classshaan97_1_1sync_1_1_server_a031f6b51241c6440b6bc452ddcd124f5}\label{classshaan97_1_1sync_1_1_server_a031f6b51241c6440b6bc452ddcd124f5}} 
\index{shaan97\+::sync\+::\+Server@{shaan97\+::sync\+::\+Server}!heartbeats@{heartbeats}}
\index{heartbeats@{heartbeats}!shaan97\+::sync\+::\+Server@{shaan97\+::sync\+::\+Server}}
\subsubsection{\texorpdfstring{heartbeats}{heartbeats}}
{\footnotesize\ttfamily std\+::unordered\+\_\+map$<$\hyperlink{namespaceshaan97_1_1sync_a34cebf175d27dfc3d82f24608f7043c1}{G\+R\+O\+U\+P\+\_\+\+ID}, std\+::pair$<$std\+::time\+\_\+t, std\+::mutex$>$ $>$ shaan97\+::sync\+::\+Server\+::heartbeats\hspace{0.3cm}{\ttfamily [private]}}

We map gid to a time\+\_\+t and it\textquotesingle{}s respective mutex (finer grained concurrency, and prevents heartbeat overload attacks).

\begin{DoxyNote}{Note}
Make sure to follow the ordering specified for lock acquisition to prevent deadlocks 
\end{DoxyNote}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/home/shaan/\+Desktop/\+Computer Science/\+Sync/inc/\hyperlink{_server_8h}{Server.\+h}\item 
/home/shaan/\+Desktop/\+Computer Science/\+Sync/src/\hyperlink{_server_8cpp}{Server.\+cpp}\end{DoxyCompactItemize}
